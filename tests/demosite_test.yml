---
name: DemositeTestSuite
description: Tests demosite resource

principals:
  user1:
    id: id_user2
    roles: ["root"]
  
  user2:
    id: id_user1
    roles: ["admin"]

  user3:
    id: id_user0
    roles: ["member"]


resources:
  resource1:
    id: id_demosite
    kind: "demosite"

tests:
  - name: Accessing demosite resource
    input:
      principals: [ "user1", "user2", "user3"]
      resources: ["resource1"]
      actions: ["create_organization"]
    expected:

      - principal: user1
        resource: resource1
        actions:
          create_organization: EFFECT_ALLOW
      - principal: user2
        resource: resource1
        actions:
          create_organization: EFFECT_ALLOW
      - principal: user3
        resource: resource1
        actions:
          create_organization: EFFECT_ALLOW