---
name: OrganizationTestSuite
description: Tests demosite resource

principals:
  user1:
    id: id_user1
    roles: ["owner"]
  
  user2:
    id: id_user2
    roles: ["admin"]

  user3:
    id: id_user3
    roles: ["member"]


resources:
  resource1:
    id: id_demosite
    scope: "user"
    kind: "organization"
    attr:
      role: "owner"

tests:
  - name: test join_user action
    input:
      principals: [ "user1", "user2", "user3"]
      resources: ["resource1"]
      actions: ["join_user"]
    expected:
      - principal: user1
        resource: resource1
        actions:
          join_user: EFFECT_ALLOW
      - principal: user2
        resource: resource1
        actions:
          join_user: EFFECT_ALLOW
      - principal: user3
        resource: resource1
        actions:
          join_user: EFFECT_DENY
  
  - name: test delete_user action
    input:
      principals: ["user2"]
      resources: ["resource1"]
      actions: ["delete_user"]
    expected:
      - principal: user2
        resource: resource1
        actions:
          delete_user: EFFECT_DENY